<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">

	<ui:composition>
		<h:form id="patientDetails" rendered="#{sessionScope.role == 'Doctor'}" >
			<div id="patientHeading">
				<h3><span id="patientHeadingLabel">Patient's Profile:</span> #{doctorBean.currentPatient.theName}</h3>
			</div>		
		    <p:accordionPanel multiple="true" activeIndex = "0,1,2">
		        <p:tab title="Bio">
		        	<div id="bio">
		  				<div id="pic">
		  					<img src="#{resource['images/emptyprofilepic.png']}" alt="patient's photo" style="width: 100px" />
		  				</div>      	
		        		<div class="biolabel">
		        			<div id="namelabel">Full Name</div>
		        			<div id="addresslabel">Address</div>
		        			<div id="emaillabel">Email</div>
		        			<div id="medicalcardlabel">HealthCard No.</div>
		        			<div id="allergieslabel">Allergies</div>
		        		</div>
		        		<div class="biodata">
		        			<div id="namedata"><h:outputText value="#{doctorBean.currentPatient.theName}"/></div>
		        			<div id="addressdata"><h:outputText value="#{doctorBean.currentPatient.theAddress}"/></div>
		        			<div id="emaildata"><h:outputText value="#{doctorBean.currentPatient.theEmail}"/></div>
		        			<div id="medicalcarddata"><h:outputText value="#{doctorBean.currentPatient.theMedicalCardNumber}"/></div>
		        			<div id="allergiesdata">
		        				<ui:repeat value="#{doctorBean.currentPatient.allergies}" var="allergy" varStatus="status">
				    			#{allergy}<h:outputText value=",&nbsp;" rendered="#{not status.last}"/><h:outputText value="." rendered="#{status.last}"/>
	                       		</ui:repeat>
		        			</div>
		        		</div>
		        	</div>
		        </p:tab>
		        <p:tab title="Prescriptions">
		        	<div id="prescriptionCards">
		        			<p:commandLink action = "#{prescriptionController.createPrescription}" 
										   update="prescriptionDetailsSection">
								<div class="prescriptionMiniCard" id="createPrescriptionCard">
									<i class="fa fa-plus shining"></i>
									<div class="prescriptionMiniCardLabel">
										New Prescription
									</div>
								</div>
							</p:commandLink>
							<ui:repeat value="#{doctorBean.currentPatient.prescriptions}" var="prescription" varStatus="status">
								<p:commandLink action = "#{doctorBean.setCurrentPrescription(prescription)}" 
										   update="prescriptionDetailsSection">
									<div class="prescriptionMiniCard">
										<div class="prescriptionMiniCardLabel">
											#{prescription.theName} #{prescription.theDatePrescribed}
										</div>
									</div>
								</p:commandLink>
							</ui:repeat>       	
		        	</div>                
		        </p:tab>
		    </p:accordionPanel>
	    </h:form>
	</ui:composition>
</html>
